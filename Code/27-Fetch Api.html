<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    // Javacript can be used to send and retrieve information from the network when needed.(AJAX)("Asynchronous Javascript And XML")

    //  ---------- Fetch api is used to get data over internet ------------/

    // let promise = fetch(url,[options])  // without options , a get request is sent
    // Getting a response is  a 2-stage process:
    //   1. An object of response class containing "status" & "ok" properties
    //   status => The http status code e.g: 200
    //   ok => boolean, true if the http status code is 200-299
    //   2. After that we need to call another method to access the body in different formats
    //   response.text() =>  Read and return the text
    //   response.json() =>  parse the response as json
    // Other methods include response.formData(),response.blob(), response.arrayBuffer() etc
    // Note: We can use only body.reading method. eg; if we ave already got the response with response.text() then response.json wont work
    // Response headers:
    // Response headers are available in response.headers
    // Request headers : To set a request header in fetch, we can use the header option:
    //    let res = fetch (url,{
    //                       headers :{
    //                            Authentication : 'secret'
    //                              }
    //                     })


    // let p2 = fetch("https://goweather.herokuapp.com/weather/Ny");
    // p2.then((respo) => {
    //   return respo.json();
    // }).then((respon) => {
    //   console.log(respon);
    // });
    ///////-----------------
    // let p = fetch("https://goweather.herokuapp.com/weather/Ny")
    // p.then((respo) => {  //response
    //         console.log(respo.status)
    //         console.log(respo.ok)
    //         // console.log(respo.headers)
    //         return respo.json()
    //   })
    //   p.then((value2) => {
    //         console.log(value2)
    // })

    // GET requests are intended to retrieve data from a server and do not modify the server's state. On the other hand, POST requests are used to send data to the server for processing and may modify the server's state.

    //========================== Sending POST request with Fetch API ======================

    // POST request => To make a post request, we need to use fetch options
    // 1. method =>  HTTP-method, e.g  POST 
    // 2. body => the request body 
    // 
    //       let respons = await fetch('url',{
    //         method:"Post",
    //         headers: {
    //           'Content-Type':'application/json'
    //         },
    //         body:'{"a" : "harry}'
    //       })
    // let result = await respons.json


    // Example:
    const createTodo = async (todo) => {
      let options = {
        method: "Post",
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(todo)
      }
      let p = await fetch('https://jsonplaceholder.typicode.com/posts', options)
      let response = await p.json()
      return response
    }

    // Another function but the upper one is also using below
    
    const getTodo = async (id) => {
      let response = await fetch('https://jsonplaceholder.typicode.com/posts/' + id)
      let r = await response.json()
      return r
    }

    const mainFunc = async () => {
      let todo = {
        title: 'HANXLA2',
        body: 'HANXI2',
        userID: 99999
      }
      let todor = await createTodo(todo)
      console.log(todor)

      console.log(await (getTodo(2)))
    }

    mainFunc()
  </script>
</body>

</html>